\chapter{Motori e sensori}
In questo capitolo verranno esaminati in dettaglio
le API (\emph{Application Programming Interface}) 
utilizzate nella gestione dei motori e dei sensori.\\
Per brevità di trattazione verrano illustrati solamente i
comandi più comuni e utilizzati, si rimanda alla 
documentazione di \emph{Lejos} per approfondimenti.

\section{Il motore}
Nei motori di \emph{Lego}\textregistered~NXT sono dotati di un
tachimetro che, con un controllo in retroazione,
permette di far ruotare i motori per un determinato angolo,
con un'incertezza di 2 gradi.\\
Al brick NXT è possibile collegare fino a tre motori.  

\subsection{La classe Motor}
La classe \texttt{Motor} consente sia il controllo diretto
di un motore collegato ad una porta (A,B,C), sia l'istanziamento
di un nuovo oggeto di tipo \texttt{Motor} tramite il costruttore.\\
La prima modalità è implementata tramite campi statici dichiarati
nella classe, la seconda tramite il costruttore:
\begin{lstlisting}
	Motor(TachoMotorPort port)
\end{lstlisting}
che ha come parametro un'implementazione dell'interfaccia
\texttt{TachoMotorPort}, ad esempio \texttt{MotorPort}, che 
indichi a quale porta associare il nuovo oggetto.\\
\\
La classe \texttt{Motor} mette a disposizione numerosi metodi,
i più utilizzati sono:
\begin{lstlisting}
 /** rotazione continua all'indietro */
 void backward(); 
 /** rotazione continua in avanti */
 void forward();
 /** velocità corrente in gradi al secondo */
 int getSpeed();
 /** restituisce vero se il motore è in movimento */
 boolean isMoving();   
 /** restituisce vero se il movimneto di rotazione ad 
  un angolo specifcio non è stato completato */
 boolean isRotating();
 /** azzera il contatore del tachimetro */
 void resetTachoCount();
 /** inverte il senso di rotazione */
 void reverseDirection();
 /** ruota di un determinato angolo rispetto alla  posizione 
	 corrente, se  immediateReturn è true, allora il metodo non 
	 è bloccante e resituisce subito il controllo completando 
	 la rotazione autonomamente */
 void rotate(int angle, boolean immediateReturn);  
 /** ruota all'angolo limitAngle rispetto al riferimento, 
	 se  immediateReturn è  true, allora il metodo non è 
	 bloccante e resituisce subito  il controllo completando 
	 la rotazione autonomamente */
 void rotateTo(int limitAngle, boolean immediateReturn);
 /* imposta la potenza del motore, power <= 900 */
 void setPower(int power);
 /* ferma il motore */
 void stop(); 
\end{lstlisting}

\section{I sensori}
Al brick \emph{Lego}\textregistered~NXT è possibile
collegare diversi tipi di sensori.\\
I sensori prodotti dalla casa madre \emph{Lego}\textregistered~sono:
\begin{itemize}
  \item pressione
  \item luce
  \item suono
  \item colore
  \item ultasuoni
  \item bussola
  \item accelerometro
  \item infrarossi
  \item giroscopio
\end{itemize} 
Molti altri tipi di sensori, prodotti da ditte specializzate o da 
appassionati, possono essere acquistati on-line.\\
\\
Il brick \emph{Lego}\textregistered~NXT supporta fino a 4 sensori.\\
La classe \texttt{SensorPort} mette a disposizione 4 campi statici
(S1, S2, S3 ed S4), che sono istanze di \texttt{SensorPort} 
e che coincidono con le 4 porte del bick.\\
Siccome i dati letti hanno significato diverso per ogni tipo di
sensore, per ciascuno di essi \emph{Lejos} fornisce
una classe in grado di interpretare corretamente i dati ricevuti.

\subsection{Il sensore di pressione}
\begin{figure}
  \begin{center}
	\includegraphics[scale=0.3]{img/sensPress.jpg}
	\caption{Il sensore di pressione}
  \end{center}
\end{figure}



\subsection{Il sensore di colore}
\begin{figure}
  \begin{center}
	\includegraphics[scale=0.3]{img/sensColor.jpg}
	\caption{Il sensore di colore}
  \end{center}
\end{figure}